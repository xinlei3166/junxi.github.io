<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Centos-7下saltstack安装配置详解 | 君惜</title>
    <meta name="description" content="欢迎来到君惜的网站。">
    <meta name="generator" content="VitePress v1.5.0">
    <link rel="preload stylesheet" href="/assets/style.CXFzMf3B.css" as="style">
    <link rel="preload stylesheet" href="/vp-icons.css" as="style">
    
    <script type="module" src="/assets/app.Bsv5TVZm.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/theme.a10mK1Mz.js">
    <link rel="modulepreload" href="/assets/chunks/framework.CgtRPpXH.js">
    <link rel="modulepreload" href="/assets/blog_Linux_Centos-7下saltstack安装配置详解.md.Cdvsc7u4.lean.js">
    <script src="/live2d.js"></script>
    <link rel="icon" type="image/png" href="/logo.png">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-d1264ba6><!--[--><!--]--><!--[--><span tabindex="-1" data-v-16212434></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-16212434> Skip to content </a><!--]--><!----><header class="VPNav" data-v-d1264ba6 data-v-496b2837><div class="VPNavBar has-sidebar top" data-v-496b2837 data-v-cac52d05><div class="wrapper" data-v-cac52d05><div class="container" data-v-cac52d05><div class="title" data-v-cac52d05><div class="VPNavBarTitle has-sidebar" data-v-cac52d05 data-v-f3edda9c><a class="title" href="/" data-v-f3edda9c><!--[--><!--]--><!--[--><img class="VPImage logo" src="/logo.png" alt data-v-4a1699af><!--]--><span data-v-f3edda9c>君惜</span><!--[--><!--]--></a></div></div><div class="content" data-v-cac52d05><div class="content-body" data-v-cac52d05><!--[--><!--]--><div class="VPNavBarSearch search" data-v-cac52d05><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-cac52d05 data-v-4724067d><span id="main-nav-aria-label" class="visually-hidden" data-v-4724067d> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/" tabindex="0" data-v-4724067d data-v-1d8e9418><!--[--><span data-v-1d8e9418>主页</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/softwareCustom/" tabindex="0" data-v-4724067d data-v-1d8e9418><!--[--><span data-v-1d8e9418>软件定制</span><!--]--></a><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-4724067d data-v-d16fee32><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-d16fee32><span class="text" data-v-d16fee32><!----><span data-v-d16fee32>博客</span><span class="vpi-chevron-down text-icon" data-v-d16fee32></span></span></button><div class="menu" data-v-d16fee32><div class="VPMenu" data-v-d16fee32 data-v-932e1d2d><div class="items" data-v-932e1d2d><!--[--><!--[--><div class="VPMenuLink" data-v-932e1d2d data-v-56977bff><a class="VPLink link" href="/blog/Docker/Docker文档.html" data-v-56977bff><!--[--><span data-v-56977bff>Docker</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-932e1d2d data-v-56977bff><a class="VPLink link" href="/blog/Git/Git学习笔记.html" data-v-56977bff><!--[--><span data-v-56977bff>Git</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-932e1d2d data-v-56977bff><a class="VPLink link" href="/blog/JavaScript/JavaScript原型继承.html" data-v-56977bff><!--[--><span data-v-56977bff>JavaScript</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-932e1d2d data-v-56977bff><a class="VPLink link active" href="/blog/Linux/Centos-7-下安装LNMP官方最新版（yum安装nginx和mysql，php7源码安装）.html" data-v-56977bff><!--[--><span data-v-56977bff>Linux</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-932e1d2d data-v-56977bff><a class="VPLink link" href="/blog/MySQL/MySQL中常用SQL语句的编写.html" data-v-56977bff><!--[--><span data-v-56977bff>MySQL</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-932e1d2d data-v-56977bff><a class="VPLink link" href="/blog/Node.js/Node.js - 使用pm2部署项目.html" data-v-56977bff><!--[--><span data-v-56977bff>Node.js</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-932e1d2d data-v-56977bff><a class="VPLink link" href="/blog/Python/Django-2-0-发布，都有哪些新特性要注意？.html" data-v-56977bff><!--[--><span data-v-56977bff>Python</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-932e1d2d data-v-56977bff><a class="VPLink link" href="/blog/Redis/使用python来操作redis用法详解.html" data-v-56977bff><!--[--><span data-v-56977bff>Redis</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-932e1d2d data-v-56977bff><a class="VPLink link" href="/blog/并发测试/ab安装及使用.html" data-v-56977bff><!--[--><span data-v-56977bff>并发测试</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-932e1d2d data-v-56977bff><a class="VPLink link" href="/blog/随笔/代码编写前需要准备的事情.html" data-v-56977bff><!--[--><span data-v-56977bff>随笔</span><!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/package/" tabindex="0" data-v-4724067d data-v-1d8e9418><!--[--><span data-v-1d8e9418>开源项目</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/about/" tabindex="0" data-v-4724067d data-v-1d8e9418><!--[--><span data-v-1d8e9418>关于我</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-cac52d05 data-v-264bc36b><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to dark theme" aria-checked="false" data-v-264bc36b data-v-9b1c1f8c data-v-470083d2><span class="check" data-v-470083d2><span class="icon" data-v-470083d2><!--[--><span class="vpi-sun sun" data-v-9b1c1f8c></span><span class="vpi-moon moon" data-v-9b1c1f8c></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-cac52d05 data-v-f7eb2e59 data-v-448c5e6f><!--[--><a class="VPSocialLink no-icon" href="https://github.com/xinlei3166/xinlei3166.github.io" aria-label="github" target="_blank" rel="noopener" data-v-448c5e6f data-v-ca0ec1b5><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-cac52d05 data-v-f8dea7aa data-v-d16fee32><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-d16fee32><span class="vpi-more-horizontal icon" data-v-d16fee32></span></button><div class="menu" data-v-d16fee32><div class="VPMenu" data-v-d16fee32 data-v-932e1d2d><!----><!--[--><!--[--><!----><div class="group" data-v-f8dea7aa><div class="item appearance" data-v-f8dea7aa><p class="label" data-v-f8dea7aa>Appearance</p><div class="appearance-action" data-v-f8dea7aa><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to dark theme" aria-checked="false" data-v-f8dea7aa data-v-9b1c1f8c data-v-470083d2><span class="check" data-v-470083d2><span class="icon" data-v-470083d2><!--[--><span class="vpi-sun sun" data-v-9b1c1f8c></span><span class="vpi-moon moon" data-v-9b1c1f8c></span><!--]--></span></span></button></div></div></div><div class="group" data-v-f8dea7aa><div class="item social-links" data-v-f8dea7aa><div class="VPSocialLinks social-links-list" data-v-f8dea7aa data-v-448c5e6f><!--[--><a class="VPSocialLink no-icon" href="https://github.com/xinlei3166/xinlei3166.github.io" aria-label="github" target="_blank" rel="noopener" data-v-448c5e6f data-v-ca0ec1b5><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-cac52d05 data-v-9b1c3370><span class="container" data-v-9b1c3370><span class="top" data-v-9b1c3370></span><span class="middle" data-v-9b1c3370></span><span class="bottom" data-v-9b1c3370></span></span></button></div></div></div></div><div class="divider" data-v-cac52d05><div class="divider-line" data-v-cac52d05></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-d1264ba6 data-v-aa3d1490><div class="container" data-v-aa3d1490><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-aa3d1490><span class="vpi-align-left menu-icon" data-v-aa3d1490></span><span class="menu-text" data-v-aa3d1490>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-aa3d1490 data-v-e13db851><button data-v-e13db851>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-d1264ba6 data-v-91d5fd9c><div class="curtain" data-v-91d5fd9c></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-91d5fd9c><span class="visually-hidden" id="sidebar-aria-label" data-v-91d5fd9c> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-0611b7b4><section class="VPSidebarItem level-0 has-active" data-v-0611b7b4 data-v-392721ee><div class="item" role="button" tabindex="0" data-v-392721ee><div class="indicator" data-v-392721ee></div><h2 class="text" data-v-392721ee>Linux</h2><!----></div><div class="items" data-v-392721ee><!--[--><div class="VPSidebarItem level-1 is-link" data-v-392721ee data-v-392721ee><div class="item" data-v-392721ee><div class="indicator" data-v-392721ee></div><a class="VPLink link link" href="/blog/Linux/Centos-7-%E4%B8%8B%E5%AE%89%E8%A3%85LNMP%E5%AE%98%E6%96%B9%E6%9C%80%E6%96%B0%E7%89%88%EF%BC%88yum%E5%AE%89%E8%A3%85nginx%E5%92%8Cmysql%EF%BC%8Cphp7%E6%BA%90%E7%A0%81%E5%AE%89%E8%A3%85%EF%BC%89" data-v-392721ee><!--[--><p class="text" data-v-392721ee>Centos-7-下安装LNMP官方最新版（yum安装nginx和mysql，php7源码安装）</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-392721ee data-v-392721ee><div class="item" data-v-392721ee><div class="indicator" data-v-392721ee></div><a class="VPLink link link" href="/blog/Linux/Centos-7%E4%B8%8BNagios%E7%9A%84%E5%AE%89%E8%A3%85%E5%8F%8A%E9%85%8D%E7%BD%AE%EF%BC%88%E5%AE%8C%E6%95%B4%E7%89%88%EF%BC%89" data-v-392721ee><!--[--><p class="text" data-v-392721ee>Centos-7下Nagios的安装及配置（完整版）</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-392721ee data-v-392721ee><div class="item" data-v-392721ee><div class="indicator" data-v-392721ee></div><a class="VPLink link link" href="/blog/Linux/Centos-7%E4%B8%8Bsaltstack%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE%E8%AF%A6%E8%A7%A3" data-v-392721ee><!--[--><p class="text" data-v-392721ee>Centos-7下saltstack安装配置详解</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-392721ee data-v-392721ee><div class="item" data-v-392721ee><div class="indicator" data-v-392721ee></div><a class="VPLink link link" href="/blog/Linux/Centos-7%E5%AE%89%E8%A3%85zabbix" data-v-392721ee><!--[--><p class="text" data-v-392721ee>Centos-7安装zabbix</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-392721ee data-v-392721ee><div class="item" data-v-392721ee><div class="indicator" data-v-392721ee></div><a class="VPLink link link" href="/blog/Linux/Centos-7%E7%B3%BB%E7%BB%9F%E4%BC%98%E5%8C%96%E8%84%9A%E6%9C%AC" data-v-392721ee><!--[--><p class="text" data-v-392721ee>Centos-7系统优化脚本</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-392721ee data-v-392721ee><div class="item" data-v-392721ee><div class="indicator" data-v-392721ee></div><a class="VPLink link link" href="/blog/Linux/Centos7%E4%B8%8B%E7%BC%96%E8%AF%91%E5%AE%89%E8%A3%85Nginx%E3%80%81Mysql%E3%80%81PHP%EF%BC%88%E6%96%87%E7%AB%A0%E5%BA%95%E9%83%A8%E5%8C%85%E5%90%AB%E4%B8%80%E9%94%AE%E5%AE%89%E8%A3%85%E8%84%9A%E6%9C%AC%EF%BC%89" data-v-392721ee><!--[--><p class="text" data-v-392721ee>Centos7下编译安装Nginx、Mysql、PHP（文章底部包含一键安装脚本）</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-392721ee data-v-392721ee><div class="item" data-v-392721ee><div class="indicator" data-v-392721ee></div><a class="VPLink link link" href="/blog/Linux/Centos%E4%B8%8B%E5%AE%89%E8%A3%85Ansible" data-v-392721ee><!--[--><p class="text" data-v-392721ee>Centos下安装Ansible</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-392721ee data-v-392721ee><div class="item" data-v-392721ee><div class="indicator" data-v-392721ee></div><a class="VPLink link link" href="/blog/Linux/curl%E4%BD%BF%E7%94%A8%E6%96%87%E6%A1%A3" data-v-392721ee><!--[--><p class="text" data-v-392721ee>curl使用文档</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-392721ee data-v-392721ee><div class="item" data-v-392721ee><div class="indicator" data-v-392721ee></div><a class="VPLink link link" href="/blog/Linux/php%E6%B7%BB%E5%8A%A0%E6%89%A9%E5%B1%95%E5%BA%93" data-v-392721ee><!--[--><p class="text" data-v-392721ee>php添加扩展库</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-392721ee data-v-392721ee><div class="item" data-v-392721ee><div class="indicator" data-v-392721ee></div><a class="VPLink link link" href="/blog/Linux/saltstack-api%E4%BD%BF%E7%94%A8%E8%AF%A6%E8%A7%A3" data-v-392721ee><!--[--><p class="text" data-v-392721ee>saltstack-api使用详解</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-392721ee data-v-392721ee><div class="item" data-v-392721ee><div class="indicator" data-v-392721ee></div><a class="VPLink link link" href="/blog/Linux/supervisor%E7%94%A8%E6%B3%95" data-v-392721ee><!--[--><p class="text" data-v-392721ee>supervisor用法</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-d1264ba6 data-v-cb39b595><div class="VPDoc has-sidebar has-aside" data-v-cb39b595 data-v-717456d7><!--[--><!--]--><div class="container" data-v-717456d7><div class="aside" data-v-717456d7><div class="aside-curtain" data-v-717456d7></div><div class="aside-container" data-v-717456d7><div class="aside-content" data-v-717456d7><div class="VPDocAside" data-v-717456d7 data-v-e8d46413><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-e8d46413 data-v-57eda6b0><div class="content" data-v-57eda6b0><div class="outline-marker" data-v-57eda6b0></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-57eda6b0>本页目录</div><ul class="VPDocOutlineItem root" data-v-57eda6b0 data-v-9e09e3dd><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-e8d46413></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-717456d7><div class="content-container" data-v-717456d7><!--[--><!--]--><main class="main" data-v-717456d7><div style="position:relative;" class="vp-doc _blog_Linux_Centos-7%E4%B8%8Bsaltstack%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AE%E8%AF%A6%E8%A7%A3" data-v-717456d7><div><h1 id="简述" tabindex="-1">简述 <a class="header-anchor" href="#简述" aria-label="Permalink to &quot;简述&quot;">​</a></h1><blockquote><p><strong>saltstack</strong></p></blockquote><ul><li><p>saltstack是一个新的基础平台管理工具，只需要花费数分钟即可运行起来，可以支撑管理上万台服务器的规模，数秒钟即可完成数据传递。</p></li><li><p>saltstack是使用python语言开发的，同时也支持restAPI方便二次开发以及和它平台集成，同时官方也发布了一个Web管理界面halite。</p></li></ul><blockquote><p><strong>优点：</strong></p></blockquote><ul><li>首先，他速度快，基于消息队列+线程，跑完多台设备，都是毫秒级别的</li><li>其次，非常灵活，源码是python，方便理解和自定义模块（python 语言相对于其他的perl、ruby等还是很好理解的）</li><li>命令简单，功能强大</li></ul><blockquote><p><strong>saltstack运行方式</strong></p></blockquote><ul><li>Local</li><li>Master/Minion</li><li>Salt SSH</li></ul><p>本文使用Master/Minion运行方式。</p><blockquote><p><strong>saltstack三大功能</strong></p></blockquote><ul><li>远程执行</li><li>配置管理</li><li>云管理</li></ul><blockquote><p><strong>saltstack数据系统</strong></p><ul><li>Grains （静态数据）</li><li>pillar （动态数据）</li></ul></blockquote><blockquote><p><strong>saltstack配置管理</strong></p></blockquote><ul><li>SLS（YAML、Jinja）</li><li>Highstate</li><li>States Module</li></ul><h1 id="实现环境" tabindex="-1">实现环境 <a class="header-anchor" href="#实现环境" aria-label="Permalink to &quot;实现环境&quot;">​</a></h1><p>准备三台机器，这三台机器都关闭 selinux，清空防火墙规则。</p><blockquote><ul><li>saltstack ==&gt; 172.16.0.19 （服务端）</li><li>client1 ==&gt; 172.16.0.20 （客户端）</li><li>client2 ==&gt; 172.16.0.21 （客户端）</li></ul></blockquote><p>查看版本和内核</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack ~]# cat /etc/redhat-release</span></span>
<span class="line"><span>CentOS Linux release 7.3.1611 (Core) </span></span>
<span class="line"><span>[root@saltstack ~]# uname -rm</span></span>
<span class="line"><span>3.10.0-514.6.1.el7.x86_64 x86_64</span></span></code></pre></div><p>分别设置 hostname，设置完毕xshell注销重新连接一下</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack ~]# hostnamectl set-hostname saltstack</span></span>
<span class="line"><span>[root@client1 ~]# hostnamectl set-hostname client1</span></span>
<span class="line"><span>[root@client2 ~]# hostnamectl set-hostname client2</span></span></code></pre></div><p>编辑 hosts 文件 每台都设置，若机器太多，可以通过搭建 DNS，则不用在每台机器上设置这个</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack ~]# vi /etc/hosts</span></span>
<span class="line"><span>添加下面内容</span></span>
<span class="line"><span>172.16.0.19 saltstack</span></span>
<span class="line"><span>172.16.0.20 client1</span></span>
<span class="line"><span>172.16.0.21 client2</span></span></code></pre></div><h1 id="开始安装" tabindex="-1">开始安装 <a class="header-anchor" href="#开始安装" aria-label="Permalink to &quot;开始安装&quot;">​</a></h1><p>分别为三台机器添加阿里云epel源</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack ~]# mv /etc/yum.repos.d/epel.repo /etc/yum.repos.d/epel.repo.backup</span></span>
<span class="line"><span>[root@saltstack ~]# mv /etc/yum.repos.d/epel-testing.repo /etc/yum.repos.d/epel-testing.repo.backup</span></span>
<span class="line"><span>[root@saltstack ~]# wget -O /etc/yum.repos.d/epel.repo http://mirrors.aliyun.com/repo/epel-7.repo</span></span></code></pre></div><p>服务端安装</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack ~]# yum -y install salt-master salt-minion</span></span></code></pre></div><p>客户端安装</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@client1 ~]# yum -y install salt-minion</span></span></code></pre></div><p>客户端安装</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@client2 ~]# yum -y install salt-minion</span></span></code></pre></div><h1 id="配置master" tabindex="-1">配置master <a class="header-anchor" href="#配置master" aria-label="Permalink to &quot;配置master&quot;">​</a></h1><p>服务端和客户端都要配置</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack ~]# vi /etc/salt/minion +16</span></span>
<span class="line"><span>以下两种方式都可以，选择其中一种即可</span></span>
<span class="line"><span># master改为服务端的主机名</span></span>
<span class="line"><span>master: saltstack    </span></span>
<span class="line"><span># master改为服务端的IP</span></span>
<span class="line"><span>master: 172.16.0.19</span></span></code></pre></div><p>分别修改三台机器minion文件中的的id为自己的主机名</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@client1 ~]# vi /etc/salt/minion +78</span></span>
<span class="line"><span>id: client1</span></span>
<span class="line"><span>[root@client2 ~]# vi /etc/salt/minion +78</span></span>
<span class="line"><span>id: client2</span></span></code></pre></div><p>启动saltstack服务 服务端</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack ~]# systemctl enable salt-master</span></span>
<span class="line"><span>[root@saltstack ~]# systemctl enable salt-minion</span></span>
<span class="line"><span>[root@saltstack ~]# systemctl start salt-master</span></span>
<span class="line"><span>[root@saltstack ~]# systemctl start salt-minion</span></span></code></pre></div><p>客户端</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@client1 ~]# systemctl enable salt-minion</span></span>
<span class="line"><span>[root@client1 ~]# systemctl start salt-minion</span></span></code></pre></div><h1 id="配置认证" tabindex="-1">配置认证 <a class="header-anchor" href="#配置认证" aria-label="Permalink to &quot;配置认证&quot;">​</a></h1><p>服务端操作</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack ~]# salt-key -a client1</span></span>
<span class="line"><span>The following keys are going to be accepted:</span></span>
<span class="line"><span>Unaccepted Keys:</span></span>
<span class="line"><span>client1</span></span>
<span class="line"><span>Proceed? [n/Y] y     </span></span>
<span class="line"><span>Key for minion client1 accepted.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[root@saltstack ~]# salt-key -a client2</span></span>
<span class="line"><span>The following keys are going to be accepted:</span></span>
<span class="line"><span>Unaccepted Keys:</span></span>
<span class="line"><span>client2</span></span>
<span class="line"><span>Proceed? [n/Y] y</span></span>
<span class="line"><span>Key for minion client2 accepted.</span></span>
<span class="line"><span>[root@saltstack ~]# salt-key -a saltstack</span></span>
<span class="line"><span>The following keys are going to be accepted:</span></span>
<span class="line"><span>Unaccepted Keys:</span></span>
<span class="line"><span>saltstack</span></span>
<span class="line"><span>Proceed? [n/Y] y</span></span>
<span class="line"><span>Key for minion saltstack accepted.</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[root@saltstack ~]# salt-key </span></span>
<span class="line"><span>Accepted Keys:</span></span>
<span class="line"><span>client1</span></span>
<span class="line"><span>client2</span></span>
<span class="line"><span>saltstack</span></span>
<span class="line"><span>Denied Keys:</span></span>
<span class="line"><span>Unaccepted Keys:</span></span>
<span class="line"><span>Rejected Keys:</span></span></code></pre></div><p>说明：-a ：accept ，-A：accept-all，-d：delete，-D：delete-all。可以使用 salt-key 命令查看到已经签名的客户端。此时我们在客户端的 /etc/salt/pki/minion 目录下面会多出一个minion_master.pub 文件。</p><p>测试验证 示例1： salt &#39;*&#39; test.ping //检测通讯是否正常，也可以指定其中一个 &#39;client1&#39;</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack ~]# salt &#39;*&#39; test.ping</span></span>
<span class="line"><span>saltstack:</span></span>
<span class="line"><span>    True</span></span>
<span class="line"><span>client2:</span></span>
<span class="line"><span>    True</span></span>
<span class="line"><span>client1:</span></span>
<span class="line"><span>    True</span></span>
<span class="line"><span>[root@saltstack ~]# salt &#39;client1&#39; test.ping</span></span>
<span class="line"><span>client1:</span></span>
<span class="line"><span>    True</span></span></code></pre></div><p>示例2: salt &#39;*&#39; cmd.run &#39;df -h&#39; //远程执行命令</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack ~]# salt &#39;*&#39; cmd.run &#39;df -hT&#39;</span></span>
<span class="line"><span>client2:</span></span>
<span class="line"><span>    Filesystem     Type      Size  Used Avail Use% Mounted on</span></span>
<span class="line"><span>    /dev/sda2      xfs        17G   13G  4.2G  76% /</span></span>
<span class="line"><span>    devtmpfs       devtmpfs   97M     0   97M   0% /dev</span></span>
<span class="line"><span>    tmpfs          tmpfs     111M   12K  111M   1% /dev/shm</span></span>
<span class="line"><span>    tmpfs          tmpfs     111M  8.8M  102M   8% /run</span></span>
<span class="line"><span>    tmpfs          tmpfs     111M     0  111M   0% /sys/fs/cgroup</span></span>
<span class="line"><span>    /dev/sda1      xfs       297M  202M   96M  68% /boot</span></span>
<span class="line"><span>    tmpfs          tmpfs      23M     0   23M   0% /run/user/0</span></span>
<span class="line"><span>saltstack:</span></span>
<span class="line"><span>    Filesystem     Type      Size  Used Avail Use% Mounted on</span></span>
<span class="line"><span>    /dev/sda2      xfs        17G  6.8G   11G  40% /</span></span>
<span class="line"><span>    devtmpfs       devtmpfs  475M     0  475M   0% /dev</span></span>
<span class="line"><span>    tmpfs          tmpfs     489M   16K  489M   1% /dev/shm</span></span>
<span class="line"><span>    tmpfs          tmpfs     489M   14M  476M   3% /run</span></span>
<span class="line"><span>    tmpfs          tmpfs     489M     0  489M   0% /sys/fs/cgroup</span></span>
<span class="line"><span>    /dev/sda1      xfs       297M  202M   96M  68% /boot</span></span>
<span class="line"><span>    tmpfs          tmpfs      98M     0   98M   0% /run/user/0</span></span>
<span class="line"><span>    tmpfs          tmpfs      98M     0   98M   0% /run/user/994</span></span>
<span class="line"><span>client1:</span></span>
<span class="line"><span>    Filesystem     Type      Size  Used Avail Use% Mounted on</span></span>
<span class="line"><span>    /dev/sda2      xfs        17G   13G  4.1G  77% /</span></span>
<span class="line"><span>    devtmpfs       devtmpfs   97M     0   97M   0% /dev</span></span>
<span class="line"><span>    tmpfs          tmpfs     111M   12K  111M   1% /dev/shm</span></span>
<span class="line"><span>    tmpfs          tmpfs     111M   13M   98M  12% /run</span></span>
<span class="line"><span>    tmpfs          tmpfs     111M     0  111M   0% /sys/fs/cgroup</span></span>
<span class="line"><span>    /dev/sda1      xfs       297M  202M   96M  68% /boot</span></span>
<span class="line"><span>    tmpfs          tmpfs      23M     0   23M   0% /run/user/0</span></span></code></pre></div><p>说明： 这里的 * 必须是在 master 上已经被接受过的客户端，可以通过 salt-key 查到，通常是我们已经设定的 id 值。关于这部分内容，它支持通配、列表以及正则。 比如两台客户端 client1、client2， 那我们可以写成 salt &#39;client*&#39; salt &#39;client[2]&#39; salt -L &#39;client1,client2&#39; salt -E &#39;client(1|2)&#39; 等形式，使用列表，即多个机器用逗号分隔，而且需要加-L，使用正则必须要带-E选项。 它还支持 grains 和 pillar，分别加 -G 和 -I 选项。</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack ~]# salt -E &#39;client(1|2)&#39; cmd.run &#39;ls&#39;</span></span>
<span class="line"><span>client1:</span></span>
<span class="line"><span>    anaconda-ks.cfg</span></span>
<span class="line"><span>    initial-setup-ks.cfg</span></span>
<span class="line"><span>    one-click-install-lnmp.sh</span></span>
<span class="line"><span>client2:</span></span>
<span class="line"><span>    anaconda-ks.cfg</span></span>
<span class="line"><span>    initial-setup-ks.cfg</span></span>
<span class="line"><span>    one-click-install-lnmp.sh</span></span>
<span class="line"><span>[root@saltstack ~]# salt -L &#39;client1,client2&#39; cmd.run &#39;ls&#39;</span></span>
<span class="line"><span>client1:</span></span>
<span class="line"><span>    anaconda-ks.cfg</span></span>
<span class="line"><span>    initial-setup-ks.cfg</span></span>
<span class="line"><span>    one-click-install-lnmp.sh</span></span>
<span class="line"><span>client2:</span></span>
<span class="line"><span>    anaconda-ks.cfg</span></span>
<span class="line"><span>    initial-setup-ks.cfg</span></span>
<span class="line"><span>    one-click-install-lnmp.sh</span></span>
<span class="line"><span>[root@saltstack ~]# salt &#39;client[2]&#39; cmd.run &#39;ls&#39;</span></span>
<span class="line"><span>client2:</span></span>
<span class="line"><span>    anaconda-ks.cfg</span></span>
<span class="line"><span>    initial-setup-ks.cfg</span></span>
<span class="line"><span>    one-click-install-lnmp.sh</span></span>
<span class="line"><span>[root@saltstack ~]# salt &#39;client*&#39; cmd.run &#39;ls&#39;</span></span>
<span class="line"><span>client2:</span></span>
<span class="line"><span>    anaconda-ks.cfg</span></span>
<span class="line"><span>    initial-setup-ks.cfg</span></span>
<span class="line"><span>    one-click-install-lnmp.sh</span></span>
<span class="line"><span>client1:</span></span>
<span class="line"><span>    anaconda-ks.cfg</span></span>
<span class="line"><span>    initial-setup-ks.cfg</span></span>
<span class="line"><span>    one-click-install-lnmp.sh</span></span></code></pre></div><h1 id="grains-和-pillar" tabindex="-1">grains 和 pillar <a class="header-anchor" href="#grains-和-pillar" aria-label="Permalink to &quot;grains 和 pillar&quot;">​</a></h1><h2 id="_1、grains" tabindex="-1"><strong>1、grains</strong> <a class="header-anchor" href="#_1、grains" aria-label="Permalink to &quot;**1、grains**&quot;">​</a></h2><p>grains 是在 minion（客户端）启动时收集到的一些信息，比如操作系统类型、网卡ip等。 使用命令：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack ~]# salt &#39;client1&#39; grains.ls      // 列出所有的 grains 项目名字</span></span>
<span class="line"><span>[root@saltstack ~]# salt &#39;client1&#39; grains.items    // 列出所有的 grains 项目名以及值</span></span></code></pre></div><p>grains的信息并不是动态的，并不会时时变更，它只是在 minion 启动时收集到的。grains 也可以做配置管理</p><p>自定义 grains的方法有两种（客户端自定义配置和服务端写脚本定义）：</p><h3 id="_1-客户端配置" tabindex="-1">1.客户端配置 <a class="header-anchor" href="#_1-客户端配置" aria-label="Permalink to &quot;1.客户端配置&quot;">​</a></h3><p>缺点：每台都得去配置，机器多了配置起来不方便</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@client1 ~]# vi /etc/salt/grains     // 添加如下，注意冒号后有空格</span></span>
<span class="line"><span>role: nginx</span></span>
<span class="line"><span>env: test</span></span>
<span class="line"><span>myname: primum est</span></span></code></pre></div><p>或者</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@client2 ~]# vi /etc/salt/minion +12</span></span>
<span class="line"><span>去掉这行内容的注释</span></span>
<span class="line"><span>default_include: minion.d/*.conf</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[root@client2 ~]# cd /etc/salt/minion.d/</span></span>
<span class="line"><span>[root@client2 minion.d]# vi custom_grains.conf            // 添加下面内容</span></span>
<span class="line"><span>grains:</span></span>
<span class="line"><span>  role:  </span></span>
<span class="line"><span>    nginx</span></span>
<span class="line"><span>  env:  </span></span>
<span class="line"><span>    test</span></span>
<span class="line"><span>  myname:  </span></span>
<span class="line"><span>    primum est</span></span></code></pre></div><p>重启minion服务</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@client1 ~]# systemctl restart salt-minion</span></span>
<span class="line"><span>[root@client2 ~]# systemctl restart salt-minion</span></span></code></pre></div><p>服务端获取 grains</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack ~]# salt &#39;client*&#39; grains.item role env myname        // 列出多个</span></span>
<span class="line"><span>client1:</span></span>
<span class="line"><span>    ----------</span></span>
<span class="line"><span>    env:</span></span>
<span class="line"><span>        test</span></span>
<span class="line"><span>    myname:</span></span>
<span class="line"><span>        primum est</span></span>
<span class="line"><span>    role:</span></span>
<span class="line"><span>        nginx</span></span>
<span class="line"><span>client2:</span></span>
<span class="line"><span>    ----------</span></span>
<span class="line"><span>    env:</span></span>
<span class="line"><span>        test</span></span>
<span class="line"><span>    myname:</span></span>
<span class="line"><span>        primum est</span></span>
<span class="line"><span>    role:</span></span>
<span class="line"><span>        nginx</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[root@saltstack ~]# salt &#39;client*&#39; grains.get myname        // 列出单个</span></span>
<span class="line"><span>client1:</span></span>
<span class="line"><span>    primum est</span></span>
<span class="line"><span>client2:</span></span>
<span class="line"><span>    primum est</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[root@saltstack ~]# salt &#39;client*&#39; grains.item myname</span></span>
<span class="line"><span>client2:</span></span>
<span class="line"><span>    ----------</span></span>
<span class="line"><span>    myname:</span></span>
<span class="line"><span>        primum est</span></span>
<span class="line"><span>client1:</span></span>
<span class="line"><span>    ----------</span></span>
<span class="line"><span>    myname:</span></span>
<span class="line"><span>        primum est</span></span></code></pre></div><p>grains 在远程执行命令时很方便。我们可以按照 grains 的一些指标来操作。比如把所有的 web 服务器的 grains 的 role 设置为 nginx，那这样我们就可以批量对 nginx 的服务器进行操作了：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack ~]# salt -G role:nginx cmd.run &#39;hostname&#39;</span></span>
<span class="line"><span>client2:</span></span>
<span class="line"><span>    client2</span></span>
<span class="line"><span>client1:</span></span>
<span class="line"><span>    client1</span></span>
<span class="line"><span>[root@saltstack ~]# salt -G os:CentOs cmd.run &#39;hostname&#39;</span></span>
<span class="line"><span>client2:</span></span>
<span class="line"><span>    client2</span></span>
<span class="line"><span>client1:</span></span>
<span class="line"><span>    client1</span></span></code></pre></div><h3 id="_2-服务端写python脚本" tabindex="-1">2.服务端写Python脚本 <a class="header-anchor" href="#_2-服务端写python脚本" aria-label="Permalink to &quot;2.服务端写Python脚本&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack ~]# mkdir /srv/salt/_grains</span></span>
<span class="line"><span>[root@saltstack ~]# cd /srv/salt/_grains/</span></span>
<span class="line"><span>[root@saltstack _grains]# vi mytest.py        // 添加下面内容</span></span>
<span class="line"><span>#!/usr/bin/env python</span></span>
<span class="line"><span># _*_ coding:utf-8 _*_</span></span>
<span class="line"><span></span></span>
<span class="line"><span>import os</span></span>
<span class="line"><span></span></span>
<span class="line"><span>def my_test():</span></span>
<span class="line"><span>    grains = {}</span></span>
<span class="line"><span>    grains[&#39;say&#39;] = &#39;hello world&#39;</span></span>
<span class="line"><span>    return grains</span></span>
<span class="line"><span></span></span>
<span class="line"><span>def my_test1():</span></span>
<span class="line"><span>    grains = {}</span></span>
<span class="line"><span>    with os.popen(&#39;free -m&#39;) as f:</span></span>
<span class="line"><span>        grains[&#39;mem_usage&#39;] = f.read()</span></span>
<span class="line"><span>    return grains</span></span></code></pre></div><p>同步到客户端</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack _grains]# salt &#39;client*&#39; saltutil.sync_all</span></span></code></pre></div><p><img src="https://resources-r2.xinlei3166.com/images/4262139-db39356cf193fc95.png" alt=""></p><p>客户端验证脚本是否同步过去</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@client1 ~]# ll /var/cache/salt/minion/extmods/grains/</span></span>
<span class="line"><span>总用量 8</span></span>
<span class="line"><span>-rw------- 1 root root 266 4月  27 11:13 mytest.py</span></span>
<span class="line"><span>-rw------- 1 root root 613 4月  27 11:13 mytest.pyc</span></span></code></pre></div><p>服务端刷新模块</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack _grains]# salt &#39;client*&#39; sys.reload_modules </span></span>
<span class="line"><span>client1:</span></span>
<span class="line"><span>    True</span></span>
<span class="line"><span>client2:</span></span>
<span class="line"><span>    True</span></span></code></pre></div><p>服务端查看客户端自定义的两个监控项</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack _grains]# salt &#39;client*&#39; grains.item say</span></span>
<span class="line"><span>client1:</span></span>
<span class="line"><span>    ----------</span></span>
<span class="line"><span>    say:</span></span>
<span class="line"><span>        hello world</span></span>
<span class="line"><span>client2:</span></span>
<span class="line"><span>    ----------</span></span>
<span class="line"><span>    say:</span></span>
<span class="line"><span>        hello world</span></span>
<span class="line"><span>[root@saltstack _grains]# salt &#39;client*&#39; grains.item mem_usage</span></span>
<span class="line"><span>client2:</span></span>
<span class="line"><span>    ----------</span></span>
<span class="line"><span>    mem_usage:</span></span>
<span class="line"><span>                      total        used        free      shared  buff/cache   available</span></span>
<span class="line"><span>        Mem:            220         103          31           4          85          78</span></span>
<span class="line"><span>        Swap:          2046         176        1870</span></span>
<span class="line"><span>client1:</span></span>
<span class="line"><span>    ----------</span></span>
<span class="line"><span>    mem_usage:</span></span>
<span class="line"><span>                      total        used        free      shared  buff/cache   available</span></span>
<span class="line"><span>        Mem:            220         106          30           2          83          76</span></span>
<span class="line"><span>        Swap:          2046         178        1868</span></span></code></pre></div><p>可以看到服务端写自定义监控项的脚本，可以一键同步到所有客户端上，快捷方便。</p><h2 id="_2、pillar" tabindex="-1"><strong>2、pillar</strong> <a class="header-anchor" href="#_2、pillar" aria-label="Permalink to &quot;**2、pillar**&quot;">​</a></h2><p>pillar 和 grains 不一样，是在 master 上定义的，并且是针对 minion 定义的一些信息。像一些比较重要的数据（密码）可以存在 pillar 里，还可以定义变量等。 首先我们查看master端pillars组件是否在开启状态 查看/etc/salt/master pillar_ops: True 就代表pillars在开启状态，否则我们手动修改。 新的版本默认已经开启，继续下面内容。</p><p>查看指定minion的 pillar 值：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack ~]# salt &#39;client1&#39; pillar.items</span></span>
<span class="line"><span>client1:</span></span>
<span class="line"><span>    ----------</span></span></code></pre></div><p>服务端自定义配置 pillar</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack ~]# vi /etc/salt/master +529    // 找到如下内容，去掉#号</span></span>
<span class="line"><span>pillar_roots:</span></span>
<span class="line"><span>  base:</span></span>
<span class="line"><span>    - /srv/pillar</span></span>
<span class="line"><span>[root@saltstack ~]#  mkdir /srv/pillar</span></span>
<span class="line"><span>[root@saltstack ~]# vi /srv/pillar/test.sls    // 自定义配置文件，内容如下</span></span>
<span class="line"><span>conf: /etc/mum.conf</span></span>
<span class="line"><span>myname: primum est</span></span>
<span class="line"><span>[root@saltstack ~]# vi /srv/pillar/top.sls    // 总入口文件，内容如下</span></span>
<span class="line"><span>base:</span></span>
<span class="line"><span>  &#39;client1&#39;:</span></span>
<span class="line"><span>    - test</span></span></code></pre></div><p>重启master</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack ~]# systemctl restart salt-master</span></span></code></pre></div><p>注意：当更改完 pillar 配置文件后，我们可以通过刷新 pillar 配置来获取新的 pillar 状态：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack ~]# salt &#39;*&#39; saltutil.refresh_pillar</span></span>
<span class="line"><span>client1:</span></span>
<span class="line"><span>    True</span></span>
<span class="line"><span>saltstack:</span></span>
<span class="line"><span>    True</span></span>
<span class="line"><span>client2:</span></span>
<span class="line"><span>    True</span></span></code></pre></div><p>验证：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack ~]# salt &#39;client1&#39; pillar.items</span></span>
<span class="line"><span>client1:</span></span>
<span class="line"><span>    ----------</span></span>
<span class="line"><span>    conf:</span></span>
<span class="line"><span>        /etc/mum.conf</span></span>
<span class="line"><span>    myname:</span></span>
<span class="line"><span>        primum est</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[root@saltstack ~]# salt &#39;client1&#39; pillar.item myname</span></span>
<span class="line"><span>client1:</span></span>
<span class="line"><span>    ----------</span></span>
<span class="line"><span>    myname:</span></span>
<span class="line"><span>        primum est</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[root@saltstack ~]# salt &#39;client1&#39; pillar.item conf</span></span>
<span class="line"><span>client1:</span></span>
<span class="line"><span>    ----------</span></span>
<span class="line"><span>    conf:</span></span>
<span class="line"><span>        /etc/mum.conf</span></span></code></pre></div><p>pillar 同样可以用来作为 salt 的匹配对象。比如：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack ~]# salt -I &#39;conf:/etc/mum.conf&#39; test.ping</span></span>
<span class="line"><span>client1:</span></span>
<span class="line"><span>    True</span></span>
<span class="line"><span>[root@saltstack ~]# salt -I &#39;conf:/etc/mum.conf&#39; cmd.run &#39;w&#39;</span></span>
<span class="line"><span>client1:</span></span>
<span class="line"><span>     17:19:45 up  7:45,  1 user,  load average: 0.05, 0.03, 0.05</span></span>
<span class="line"><span>    USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT</span></span>
<span class="line"><span>    root     pts/1    172.16.0.1       11:14   25.00s  0.68s  0.68s -bash</span></span></code></pre></div><p>另外一种定义pillar的方式，也适用于state 首先编辑/srv/pillar/目录下的top.sls 文件</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack ~]# vi /srv/pillar/top.sls           // 内容如下</span></span>
<span class="line"><span>base:</span></span>
<span class="line"><span>  &#39;client1&#39;:</span></span>
<span class="line"><span>    - test</span></span>
<span class="line"><span>    - apache</span></span></code></pre></div><blockquote><p>第一行代表这是我们的入口文件 第二行代表我们要匹配的用户，‘client1’代表client1客户端，“*”代表所有用户 第三丶四行代表匹配到的用户可以看到的数据的配置文件的名字</p></blockquote><p>这里我们可以直接写一个名字叫做apache的文件进行配置,也可以写一个包含init.sls的目录进行配置。这里采用包含init.sls文件的目录的形式的配置方法。</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@saltstack </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]# cd /srv/pillar/</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@saltstack pillar]# mkdir apache</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@saltstack pillar]# cd apache/</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@saltstack apache]# vim init.sls              // 添加如下内容</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">system-type:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  {</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">%</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> if</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> grains.os</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ==</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;CentOS&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> %}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    name:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Centos-Linux</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  {</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">%</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> else</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> %}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    name:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> unknown</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  {</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">%</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> endif</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> %}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apache-name:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  {</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">%</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> if</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> grains.os_family</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ==</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;RedHat&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> %}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    apache:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> httpd</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  {</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">%</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> elif</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> grains.os_family</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ==</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;Arch&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> %}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    apache:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apache</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  {</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">%</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> elif</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> grains.os_family</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ==</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;Debian&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> %}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    apache:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apache2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  {</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">%</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> endif</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> %}</span></span></code></pre></div><blockquote><p>类似于django的模板语言（我们可以采用python脚本定义grains的数据，但是pillar没有。我们可以在pillar的sls脚本当中调用grains的变量，pillar和grains具有同样的功能可以被其他组件调用。）</p></blockquote><p>服务端查看自定义的pillar信息</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack apache]# salt &#39;client1&#39; pillar.item apache-name</span></span>
<span class="line"><span>client1:</span></span>
<span class="line"><span>    ----------</span></span>
<span class="line"><span>    apache-name:</span></span>
<span class="line"><span>        ----------</span></span>
<span class="line"><span>        apache:</span></span>
<span class="line"><span>            httpd</span></span>
<span class="line"><span>[root@saltstack apache]# salt &#39;client1&#39; pillar.item system-type</span></span>
<span class="line"><span>client1:</span></span>
<span class="line"><span>    ----------</span></span>
<span class="line"><span>    system-type:</span></span>
<span class="line"><span>        ----------</span></span>
<span class="line"><span>        name:</span></span>
<span class="line"><span>            Centos-Linux</span></span></code></pre></div><h1 id="配置管理安装apache" tabindex="-1">配置管理安装Apache <a class="header-anchor" href="#配置管理安装apache" aria-label="Permalink to &quot;配置管理安装Apache&quot;">​</a></h1><p>下面进行的演示是远程通过 yum 方式安装 Apache。步骤如下： 修改配置文件</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack ~]# vi /etc/salt/master +406    // 打开如下内容的注释</span></span>
<span class="line"><span>file_roots:</span></span>
<span class="line"><span>  base:</span></span>
<span class="line"><span>    - /srv/salt/</span></span></code></pre></div><p>注意：环境： base、dev(开发环境）、test（测试环境）、prod（生产环境）。</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack ~]# mkdir /srv/salt</span></span>
<span class="line"><span>[root@saltstack ~]# vi /srv/salt/top.sls        </span></span>
<span class="line"><span>base:</span></span>
<span class="line"><span>  &#39;client1&#39;:</span></span>
<span class="line"><span>    - apache</span></span></code></pre></div><p>注意：若换成 &#39;*&#39;，则表示在所有的客户端执行 apache 模块。</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack ~]# vi /srv/salt/apache.sls            </span></span>
<span class="line"><span>apache-service:</span></span>
<span class="line"><span>  pkg.installed:</span></span>
<span class="line"><span>    - names:                // 如果只有一个服务，那么就可以写成 –name: httpd 不用再换一行</span></span>
<span class="line"><span>      - httpd</span></span>
<span class="line"><span>      - httpd-devel</span></span>
<span class="line"><span>  service.running:</span></span>
<span class="line"><span>    - name: httpd</span></span>
<span class="line"><span>    - enable: True</span></span></code></pre></div><p>注意：apache-service 是自定义的 id 名。pkg.installed 为包安装函数，下面是要安装的包的名字。service.running 也是一个函数，来保证指定的服务启动，enable 表示开机启动。</p><p>重启服务</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack ~]# systemctl restart salt-master</span></span></code></pre></div><p>执行命令</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack ~]# salt &#39;client1&#39; state.highstate          // 执行时间比较长，因为要安装httpd</span></span></code></pre></div><p><img src="https://resources-r2.xinlei3166.com/images/4262139-200c135fab288287.png" alt=""> 如上图所示，说明 Apache 远程安装已成功。</p><h1 id="文件目录管理" tabindex="-1">文件目录管理 <a class="header-anchor" href="#文件目录管理" aria-label="Permalink to &quot;文件目录管理&quot;">​</a></h1><h2 id="_1、文件管理" tabindex="-1">1、文件管理 <a class="header-anchor" href="#_1、文件管理" aria-label="Permalink to &quot;1、文件管理&quot;">​</a></h2><p>服务端配置 编辑/srv/salt/目录下的top.sls 文件</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack ~]# vi /srv/salt/top.sls     // 修改为如下</span></span>
<span class="line"><span>base:</span></span>
<span class="line"><span>  &#39;client1&#39;:</span></span>
<span class="line"><span>    - filetest</span></span></code></pre></div><p>新建 filetest.sls 文件</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack ~]# vi /srv/salt/filetest.sls        </span></span>
<span class="line"><span>file-test:</span></span>
<span class="line"><span>  file.managed:</span></span>
<span class="line"><span>    - name: /tmp/filetest.txt</span></span>
<span class="line"><span>    - source: salt://test/123/1.txt</span></span>
<span class="line"><span>    - user: root</span></span>
<span class="line"><span>    - group: root</span></span>
<span class="line"><span>    - mode: 644</span></span></code></pre></div><p>注意：第一行的 file-test 为自定的名字，表示该配置段的名字，可以在别的配置段中引用它；source指定文件从哪里拷贝，这里的 test 目录相当于是 /srv/salt/test 目录；name指定远程客户端要生成的文件。</p><p>新建所要测试的源文件</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack ~]# mkdir -p /srv/salt/test/123</span></span>
<span class="line"><span>[root@saltstack ~]# vim /srv/salt/test/123/1.txt</span></span>
<span class="line"><span>saltstack ....</span></span>
<span class="line"><span>this is a test ....</span></span></code></pre></div><p>执行命令：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack ~]# salt &#39;client1&#39; state.highstate</span></span></code></pre></div><p><img src="https://resources-r2.xinlei3166.com/images/4262139-04ef7a78598d8277.png" alt=""></p><p>客户端验证</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@client1 ~]# ll /tmp/filetest.txt </span></span>
<span class="line"><span>-rw-r--r-- 1 root root 34 4月  26 10:58 /tmp/filetest.txt</span></span>
<span class="line"><span>[root@client1 ~]# cat /tmp/filetest.txt </span></span>
<span class="line"><span>saltstack ....</span></span>
<span class="line"><span>this is a test ...</span></span></code></pre></div><h2 id="_2、目录管理" tabindex="-1">2、目录管理 <a class="header-anchor" href="#_2、目录管理" aria-label="Permalink to &quot;2、目录管理&quot;">​</a></h2><p>服务端配置 接着编辑/srv/salt/目录下的top.sls 文件</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack ~]# vi /srv/salt/top.sls     // 修改为如下</span></span>
<span class="line"><span>base:</span></span>
<span class="line"><span>  &#39;client1&#39;:</span></span>
<span class="line"><span>    - filedir</span></span></code></pre></div><p>新建 filedir.sls 文件</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack ~]# vi /srv/salt/filedir.sls</span></span>
<span class="line"><span>file-dir:</span></span>
<span class="line"><span>  file.recurse:</span></span>
<span class="line"><span>    - name: /tmp/testdir</span></span>
<span class="line"><span>    - source: salt://test1/234</span></span>
<span class="line"><span>    - user: root</span></span>
<span class="line"><span>    - file_mode: 644</span></span>
<span class="line"><span>    - dir_mode: 755</span></span>
<span class="line"><span>    - mkdir: True</span></span>
<span class="line"><span>    - clean: True</span></span></code></pre></div><p>注意：clean: True 源删除文件或目录，目标也会跟着删除，否则不会删除。可以默认设置为 False。</p><p>新建所要测试的源目录</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack ~]# mkdir -p /srv/salt/test1/234/</span></span>
<span class="line"><span>[root@saltstack ~]# vi /srv/salt/test1/234/2.txt</span></span>
<span class="line"><span>filedir..........test</span></span>
<span class="line"><span>and add delete select alter</span></span></code></pre></div><p>执行命令：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack ~]# salt &#39;client1&#39; state.highstate</span></span></code></pre></div><p><img src="https://resources-r2.xinlei3166.com/images/4262139-b928cbc819d14e0d.png" alt=""></p><p>客户端验证</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@client1 ~]# ll /tmp/testdir/</span></span>
<span class="line"><span>总用量 4</span></span>
<span class="line"><span>-rw-r--r-- 1 root root 50 4月  26 11:11 2.txt</span></span></code></pre></div><p>测试增删功能</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack ~]# mkdir /srv/salt/test1/234/mydir</span></span>
<span class="line"><span>[root@saltstack ~]# touch /srv/salt/test1/234/mydir/111.txt</span></span>
<span class="line"><span>[root@saltstack ~]# touch /srv/salt/test1/234/testdir.add</span></span>
<span class="line"><span>[root@saltstack ~]# rm -rf /srv/salt/test1/234/2.txt</span></span></code></pre></div><p>执行命令：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack ~]# salt &#39;client1&#39; state.highstate</span></span></code></pre></div><p><img src="https://resources-r2.xinlei3166.com/images/4262139-25b0d58566f85288.png" alt=""></p><p>客户端验证</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@client1 ~]# tree /tmp/testdir/</span></span>
<span class="line"><span>/tmp/testdir/</span></span>
<span class="line"><span>|-- mydir</span></span>
<span class="line"><span>|   `-- 111.txt</span></span>
<span class="line"><span>`-- testdir.add</span></span>
<span class="line"><span></span></span>
<span class="line"><span>1 directory, 2 files</span></span></code></pre></div><p>注意：由上图可知，成功在客户端 /tmp/testdir/ 目录下创建了 mydir 目录以及 testdir.add 文件，并删除 2.txt 文件。这里值得注意的是要成功创建 mydir 目录，前提是 mydir 目录下要有文件，如这里的111.txt 文件，如若没有，客户端是不会创建 mydir 目录的。</p><h1 id="远程执行" tabindex="-1">远程执行 <a class="header-anchor" href="#远程执行" aria-label="Permalink to &quot;远程执行&quot;">​</a></h1><p>前面提到远程执行命令 test.ping，cmd.run，点前面的是模块，点后面的是函数；这样总归是不太规范化，下面详细介绍怎么远程执行命令和脚本。</p><h2 id="_1、远程执行命令" tabindex="-1">1、远程执行命令 <a class="header-anchor" href="#_1、远程执行命令" aria-label="Permalink to &quot;1、远程执行命令&quot;">​</a></h2><p>服务端配置 接着编辑/srv/salt/目录下的top.sls 文件</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack ~]# vi /srv/salt/top.sls     // 修改为如下</span></span>
<span class="line"><span>base:</span></span>
<span class="line"><span>  &#39;client1&#39;:</span></span>
<span class="line"><span>    - cmdtest</span></span></code></pre></div><p>新建 cmdtest.sls 文件</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack ~]# vi /srv/salt/cmdtest.sls</span></span>
<span class="line"><span>cmd-test:</span></span>
<span class="line"><span>  cmd.run:</span></span>
<span class="line"><span>    - onlyif: test -f /tmp/filetest.txt</span></span>
<span class="line"><span>    - names:</span></span>
<span class="line"><span>      - touch /tmp/cmdtest.txt</span></span>
<span class="line"><span>      - mkdir /tmp/cmdtest</span></span>
<span class="line"><span>    - user: root</span></span></code></pre></div><p>注意：条件 onlyif 表示若 /tmp/filetest.txt 文件存在，则执行后面的命令；可以使用 unless，两者正好相反。</p><p>执行命令：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack ~]# salt &#39;client1&#39; state.highstate</span></span></code></pre></div><p><img src="https://resources-r2.xinlei3166.com/images/4262139-7c91d81f24011ba0.png" alt=""></p><p>客户端验证</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@client1 ~]# ll /tmp/</span></span>
<span class="line"><span>总用量 156</span></span>
<span class="line"><span>drwxr-xr-x  2 root  root      6 4月  26 11:45 cmdtest</span></span>
<span class="line"><span>-rw-r--r--  1 root  root      0 4月  26 11:45 cmdtest.txt</span></span>
<span class="line"><span>-rw-r--r--  1 root  root     34 4月  26 10:58 filetest.txt</span></span>
<span class="line"><span>drwxr-xr-x  3 root  root     38 4月  26 11:14 testdir</span></span></code></pre></div><h2 id="_2、远程执行脚本" tabindex="-1">2、远程执行脚本 <a class="header-anchor" href="#_2、远程执行脚本" aria-label="Permalink to &quot;2、远程执行脚本&quot;">​</a></h2><p>服务端配置 接着编辑/srv/salt/目录下的top.sls 文件</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack ~]# vi /srv/salt/top.sls    // 修改为如下</span></span>
<span class="line"><span>base:</span></span>
<span class="line"><span>  &#39;client1&#39;:</span></span>
<span class="line"><span>    - shelltest</span></span></code></pre></div><p>新建 shelltest.sls 文件</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack ~]# vi /srv/salt/shelltest.sls</span></span>
<span class="line"><span>shell-test:</span></span>
<span class="line"><span>  cmd.script:</span></span>
<span class="line"><span>    - source: salt://test/1.sh</span></span>
<span class="line"><span>    - user: root</span></span></code></pre></div><p>新建 1.sh 脚本文件</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack ~]# vi /srv/salt/test/1.sh</span></span>
<span class="line"><span>#!/bin/sh</span></span>
<span class="line"><span>touch /tmp/shelltest.txt</span></span>
<span class="line"><span>if [ -d /tmp/shelltest ]</span></span>
<span class="line"><span>then</span></span>
<span class="line"><span>    rm -rf /tmp/shelltest</span></span>
<span class="line"><span>else</span></span>
<span class="line"><span>    mkdir /tmp/shelltest</span></span>
<span class="line"><span>fi</span></span></code></pre></div><p>执行命令：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack ~]# salt &#39;client1&#39; state.highstate</span></span></code></pre></div><p><img src="https://resources-r2.xinlei3166.com/images/4262139-af1368d545be274a.png" alt=""></p><p>客户端验证</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@client1 ~]# ll /tmp/</span></span>
<span class="line"><span>drwxr-xr-x  2 root  root      6 4月  26 12:08 shelltest</span></span>
<span class="line"><span>-rw-r--r--  1 root  root      0 4月  26 12:08 shelltest.txt</span></span></code></pre></div><p>通过上面的例子，我们实现了远程执行脚本；如果我们想一键远程安装 LAMP 或者 LNMP，那么只需把本例中的 1.sh 脚本替换成 一键安装的脚本就行。</p><h1 id="管理任务计划" tabindex="-1">管理任务计划 <a class="header-anchor" href="#管理任务计划" aria-label="Permalink to &quot;管理任务计划&quot;">​</a></h1><h2 id="_1、建立-cron" tabindex="-1">1、建立 cron <a class="header-anchor" href="#_1、建立-cron" aria-label="Permalink to &quot;1、建立 cron&quot;">​</a></h2><p>服务端配置 编辑/srv/salt/目录下的top.sls 文件</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack ~]# vi /srv/salt/top.sls     // 修改为如下</span></span>
<span class="line"><span>#base:</span></span>
<span class="line"><span>#  &#39;client1&#39;:</span></span>
<span class="line"><span>#    - apache</span></span>
<span class="line"><span>#base:</span></span>
<span class="line"><span>#  &#39;client1&#39;:</span></span>
<span class="line"><span>#    - filetest</span></span>
<span class="line"><span>#base:</span></span>
<span class="line"><span>#  &#39;client1&#39;:</span></span>
<span class="line"><span>#    - filedir</span></span>
<span class="line"><span>#base:</span></span>
<span class="line"><span>#  &#39;client1&#39;:</span></span>
<span class="line"><span>#    - cmdtest</span></span>
<span class="line"><span>#base:</span></span>
<span class="line"><span>#  &#39;client1&#39;:</span></span>
<span class="line"><span>#    - shelltest</span></span>
<span class="line"><span>#base:</span></span>
<span class="line"><span>#  &#39;client1&#39;:</span></span>
<span class="line"><span>#    - shelltest</span></span>
<span class="line"><span>base:</span></span>
<span class="line"><span>  &#39;client1&#39;:</span></span>
<span class="line"><span>    - crontest</span></span></code></pre></div><p>编辑 crontest.sls 文件</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack ~]# vim /srv/salt/crontest.sls</span></span>
<span class="line"><span>cron-test:</span></span>
<span class="line"><span>  cron.present:</span></span>
<span class="line"><span>    - name: /bin/touch /tmp/111.txt</span></span>
<span class="line"><span>    - user: root</span></span>
<span class="line"><span>    - minute: &#39;*&#39;</span></span>
<span class="line"><span>    - hour: 20</span></span>
<span class="line"><span>    - daymonth: 1-10</span></span>
<span class="line"><span>    - month: &#39;3,5&#39;</span></span>
<span class="line"><span>    - dayweek: &#39;*&#39;</span></span></code></pre></div><p>注意，*需要用单引号引起来。当然我们还可以使用 file.managed 模块来管理 cron，因为系统的 cron都是以配置文件的形式存在的。</p><p>执行命令：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack ~]# salt &#39;client1&#39; state.highstate</span></span></code></pre></div><p><img src="https://resources-r2.xinlei3166.com/images/4262139-844a1bd48458663f.png" alt=""></p><p>客户端验证</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@client1 ~]# crontab -l</span></span>
<span class="line"><span># Lines below here are managed by Salt, do not edit</span></span>
<span class="line"><span># SALT_CRON_IDENTIFIER:/bin/touch /tmp/111.txt</span></span>
<span class="line"><span>* 20 1-10 3,5 * /bin/touch /tmp/111.txt</span></span></code></pre></div><h2 id="_2、删除-cron" tabindex="-1">2、删除 cron <a class="header-anchor" href="#_2、删除-cron" aria-label="Permalink to &quot;2、删除 cron&quot;">​</a></h2><p>服务端配置 我们只需修改 crontest.sls 文件</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack ~]# vim /srv/salt/crontest.sls</span></span>
<span class="line"><span>cron.present    改为    cron.absent</span></span></code></pre></div><p>注意：两者不能共存，要想删除一个 cron，那之前的 present 就得替换掉或者删除掉。</p><p>执行命令：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack ~]# salt &#39;client1&#39; state.highstate</span></span></code></pre></div><p><img src="https://resources-r2.xinlei3166.com/images/4262139-960cc066a0407f20.png" alt=""></p><p>客户端验证</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@client1 ~]# crontab -l        // 可查看到该任务计划已删除</span></span>
<span class="line"><span># Lines below here are managed by Salt, do not edit</span></span></code></pre></div><br> # 一键搭建rsync服务 **rsync服务端搭建配置文件介绍** <div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack rsync]# cat rsync_server.sls </span></span>
<span class="line"><span>rsync:    ##ID  这个ID必须是唯一的名字</span></span>
<span class="line"><span> user.present:    ##user模块中present应用</span></span>
<span class="line"><span>   - fullname: rsync  ##用户名字</span></span>
<span class="line"><span>   - createhome: False  ##不创建家目录</span></span>
<span class="line"><span>   - shell: /sbin/nologin  ##禁止登录</span></span>
<span class="line"><span>   - empty_password: True  ##不需要密码</span></span>
<span class="line"><span>rsyncd.conf: ##ID</span></span>
<span class="line"><span> file.managed:  ##file模块</span></span>
<span class="line"><span>   - name: /etc/rsyncd.conf  ##客户端文件存放路径</span></span>
<span class="line"><span>   - source: salt://rsync/rsyncd.conf   ##服务端文件路径</span></span>
<span class="line"><span>   - user: root    ##属主</span></span>
<span class="line"><span>   - group: root  ##属组</span></span>
<span class="line"><span>   - mode: 644 ##权限</span></span>
<span class="line"><span>backup:</span></span>
<span class="line"><span> file.directory: ##file模块</span></span>
<span class="line"><span>   - name: /backup ##创建目录名</span></span>
<span class="line"><span>   - user: rsync</span></span>
<span class="line"><span>   - group: rsync</span></span>
<span class="line"><span>   - mode: 755</span></span>
<span class="line"><span>   - makedirs: True  ##如果没有自动创建</span></span>
<span class="line"><span>rsync.password:  </span></span>
<span class="line"><span> file.managed:</span></span>
<span class="line"><span>   - name: /etc/rsync.password</span></span>
<span class="line"><span>   - source: salt://rsync/rsyncd.password</span></span>
<span class="line"><span>   - user: root</span></span>
<span class="line"><span>   - group: root</span></span>
<span class="line"><span>   - mode: 600</span></span>
<span class="line"><span>daemon:</span></span>
<span class="line"><span> cmd.run:  ##使用cmd.run模块</span></span>
<span class="line"><span>   - name: rsync --daemon</span></span>
<span class="line"><span>Boot from open:</span></span>
<span class="line"><span> cmd.run:</span></span>
<span class="line"><span>   - name: echo &quot;/usr/bin/rsync --daemon&quot; &gt;&gt;/etc/rc.local</span></span></code></pre></div><p>开始部署 服务端配置 编辑/srv/salt/目录下的top.sls 文件</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack ~]# vi /srv/salt/top.sls        // 修改为下面内容</span></span>
<span class="line"><span> base:</span></span>
<span class="line"><span>  &#39;client1&#39;:</span></span>
<span class="line"><span>    - rsync.rsync_server</span></span>
<span class="line"><span>  &#39;client2&#39;:</span></span>
<span class="line"><span>    - rsync.rsync_client</span></span></code></pre></div><p>创建rsync服务端搭建配置文件</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack ~]# mkdir /srv/salt/rsync</span></span>
<span class="line"><span>[root@saltstack ~]# cd /srv/salt/rsync/</span></span>
<span class="line"><span>[root@saltstack rsync]# vi rsync_server.sls                // 添加下面内容</span></span>
<span class="line"><span>rsync:   </span></span>
<span class="line"><span>  user.present:    </span></span>
<span class="line"><span>    - fullname: rsync  </span></span>
<span class="line"><span>    - createhome: False  </span></span>
<span class="line"><span>    - shell: /sbin/nologin  </span></span>
<span class="line"><span>    - empty_password: True  </span></span>
<span class="line"><span>rsyncd.conf: ##ID</span></span>
<span class="line"><span>  file.managed:  </span></span>
<span class="line"><span>    - name: /etc/rsyncd.conf  </span></span>
<span class="line"><span>    - source: salt://rsync/rsyncd.conf   </span></span>
<span class="line"><span>    - user: root    </span></span>
<span class="line"><span>    - group: root  </span></span>
<span class="line"><span>    - mode: 644 </span></span>
<span class="line"><span>backup:</span></span>
<span class="line"><span>  file.directory: </span></span>
<span class="line"><span>    - name: /backup </span></span>
<span class="line"><span>    - user: rsync</span></span>
<span class="line"><span>    - group: rsync</span></span>
<span class="line"><span>    - mode: 755</span></span>
<span class="line"><span>    - makedirs: True  </span></span>
<span class="line"><span>rsync.password:  </span></span>
<span class="line"><span>  file.managed:</span></span>
<span class="line"><span>    - name: /etc/rsync.password</span></span>
<span class="line"><span>    - source: salt://rsync/rsyncd.password</span></span>
<span class="line"><span>    - user: root</span></span>
<span class="line"><span>    - group: root</span></span>
<span class="line"><span>    - mode: 600</span></span>
<span class="line"><span>daemon:</span></span>
<span class="line"><span>  cmd.run:  </span></span>
<span class="line"><span>    - name: rsync --daemon</span></span>
<span class="line"><span>Boot from open:</span></span>
<span class="line"><span>  cmd.run:</span></span>
<span class="line"><span>    - name: echo &quot;/usr/bin/rsync --daemon&quot; &gt;&gt;/etc/rc.local</span></span></code></pre></div><p>创建rsync客户端搭建配置文件</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack rsync]# vi rsync_client.sls              // 添加下面内容 </span></span>
<span class="line"><span>rsync.passwd:</span></span>
<span class="line"><span>  file.managed:</span></span>
<span class="line"><span>    - name: /etc/rsync.password</span></span>
<span class="line"><span>    - source: salt://rsync/rsync.password</span></span>
<span class="line"><span>    - user: root</span></span>
<span class="line"><span>    - group: root</span></span>
<span class="line"><span>    - mode: 600</span></span>
<span class="line"><span>backup:</span></span>
<span class="line"><span>  file.directory:</span></span>
<span class="line"><span>    - name: /backup</span></span>
<span class="line"><span>    - user: root</span></span>
<span class="line"><span>    - group: root</span></span>
<span class="line"><span>    - mode: 755</span></span>
<span class="line"><span>    - makedirs: True</span></span></code></pre></div><p>创建rsync服务配置文件（这里是rsync服务的配置文件，上面的是salt安装rsync服务应用的搭建配置文件）</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack rsync]# vi rsyncd.conf           // rsync配置文件</span></span>
<span class="line"><span>uid =rsync     </span></span>
<span class="line"><span>gid =rsync     </span></span>
<span class="line"><span>use chroot=no</span></span>
<span class="line"><span>max chonnections =200</span></span>
<span class="line"><span>timeout = 300</span></span>
<span class="line"><span>pid file =/var/run/rsyncd.pid</span></span>
<span class="line"><span>lock file = /var/run/rsync.lock</span></span>
<span class="line"><span>log file = /var/log/rsyncd.log</span></span>
<span class="line"><span>ignore errors</span></span>
<span class="line"><span>read only = false</span></span>
<span class="line"><span>list = false</span></span>
<span class="line"><span>hosts allow = 172.16.0.0/24</span></span>
<span class="line"><span>hosts deny = 0.0.0.0/32</span></span>
<span class="line"><span>auth users = rsync_backup</span></span>
<span class="line"><span>secrets file = /etc/rsync.password</span></span>
<span class="line"><span>[backup]                </span></span>
<span class="line"><span>path = /backup </span></span>
<span class="line"><span></span></span>
<span class="line"><span>[root@saltstack rsync]# vi rsyncd.password            // 服务端密码文件</span></span>
<span class="line"><span>rsync_backup:123456</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[root@saltstack rsync]# vi rsync.password             // 客户端密码文件</span></span>
<span class="line"><span>123456</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[root@saltstack rsync]# ll</span></span>
<span class="line"><span>总用量 20</span></span>
<span class="line"><span>-rw-r--r-- 1 root root 274 4月  26 15:17 rsync_client.sls</span></span>
<span class="line"><span>-rw-r--r-- 1 root root 376 4月  26 15:11 rsyncd.conf</span></span>
<span class="line"><span>-rw-r--r-- 1 root root  20 4月  26 15:15 rsyncd.password</span></span>
<span class="line"><span>-rw-r--r-- 1 root root   7 4月  26 15:15 rsync.password</span></span>
<span class="line"><span>-rw-r--r-- 1 root root 723 4月  26 15:16 rsync_server.sls</span></span></code></pre></div><p>验证rsync服务是否安装成功 rsync服务端查看服务是否启动</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@client1 ~]# ll /etc/rsync.password </span></span>
<span class="line"><span>-rw------- 1 root root 20 4月  26 15:24 /etc/rsync.password</span></span>
<span class="line"><span>[root@client1 ~]# cat /etc/rsync.password </span></span>
<span class="line"><span>rsync_backup:123456</span></span>
<span class="line"><span>[root@client1 ~]# ps -ef|grep rsync</span></span>
<span class="line"><span>root      12636      1  0 15:24 ?        00:00:00 rsync --daemon</span></span>
<span class="line"><span>root      12710   2400  0 15:25 pts/0    00:00:00 grep --color=auto rsync</span></span></code></pre></div><p>好极了，我们在rsync客户端推送一个文件到服务端是否成功</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@client2 ~]# cd /backup/</span></span>
<span class="line"><span>[root@client2 backup]# echo &#39;this msg from new install rsync client used by test&#39; &gt; test.txt</span></span>
<span class="line"><span>[root@client2 backup]# ls test.txt </span></span>
<span class="line"><span>test.txt</span></span>
<span class="line"><span>[root@client2 backup]# rsync -avz /backup/  rsync_backup@172.16.0.20::backup --password-file=/etc/rsync.password</span></span>
<span class="line"><span>sending incremental file list</span></span>
<span class="line"><span>./</span></span>
<span class="line"><span>test.txt</span></span>
<span class="line"><span></span></span>
<span class="line"><span>sent 132 bytes  received 30 bytes  324.00 bytes/sec</span></span>
<span class="line"><span>total size is 52  speedup is 0.32</span></span></code></pre></div><p>貌似推送成功了，快去rsync服务端看下吧</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@client1 ~]# cd /backup/</span></span>
<span class="line"><span>[root@client1 backup]# ll</span></span>
<span class="line"><span>总用量 4</span></span>
<span class="line"><span>-rw-r--r-- 1 rsync rsync 52 4月  26 15:46 test.txt</span></span>
<span class="line"><span>[root@client1 backup]# cat test.txt </span></span>
<span class="line"><span>this msg from new install rsync client used by test</span></span></code></pre></div><p>好的，顺利装完，出去抽支烟和活动下颈椎吧。</p><h1 id="saltstack-常用命令" tabindex="-1">Saltstack 常用命令 <a class="header-anchor" href="#saltstack-常用命令" aria-label="Permalink to &quot;Saltstack 常用命令&quot;">​</a></h1><h2 id="_1、拷贝文件到客户端" tabindex="-1">1、拷贝文件到客户端 <a class="header-anchor" href="#_1、拷贝文件到客户端" aria-label="Permalink to &quot;1、拷贝文件到客户端&quot;">​</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack ~]# salt &#39;client2&#39; cp.get_file salt://apache.sls /tmp/cp.txt</span></span>
<span class="line"><span>client2:</span></span>
<span class="line"><span>    /tmp/cp.txt</span></span></code></pre></div><p>客户端查看</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@client2 ~]# ll /tmp</span></span>
<span class="line"><span>总用量 4</span></span>
<span class="line"><span>-rw-r--r-- 1 root root 151 4月  26 14:04 cp.txt</span></span></code></pre></div><h2 id="_2、拷贝目录到客户端" tabindex="-1">2、拷贝目录到客户端 <a class="header-anchor" href="#_2、拷贝目录到客户端" aria-label="Permalink to &quot;2、拷贝目录到客户端&quot;">​</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack ~]# salt &#39;client2&#39; cp.get_dir salt://test /tmp</span></span>
<span class="line"><span>client2:</span></span>
<span class="line"><span>    - /tmp/test/1.sh</span></span>
<span class="line"><span>    - /tmp/test/123/1.txt</span></span></code></pre></div><p>客户端查看</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>root@client2 ~]# ll /tmp/</span></span>
<span class="line"><span>总用量 4</span></span>
<span class="line"><span>-rw-r--r-- 1 root root 151 4月  26 14:04 cp.txt</span></span>
<span class="line"><span>drwxr-xr-x 3 root root  29 4月  26 14:14 test</span></span></code></pre></div><h2 id="_3、显示存活的客户端" tabindex="-1">3、显示存活的客户端 <a class="header-anchor" href="#_3、显示存活的客户端" aria-label="Permalink to &quot;3、显示存活的客户端&quot;">​</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack ~]# salt-run manage.up</span></span>
<span class="line"><span>- client1</span></span>
<span class="line"><span>- client2</span></span>
<span class="line"><span>- saltstack</span></span></code></pre></div><h2 id="_4、命令下执行服务端的脚本" tabindex="-1">4、命令下执行服务端的脚本 <a class="header-anchor" href="#_4、命令下执行服务端的脚本" aria-label="Permalink to &quot;4、命令下执行服务端的脚本&quot;">​</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[root@saltstack ~]# vim /srv/salt/test/shell.sh</span></span>
<span class="line"><span>#! /bin/sh</span></span>
<span class="line"><span>echo &quot;salt server do run shell script on client&quot; &gt; /tmp/shell.txt</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[root@saltstack ~]# salt &#39;client2&#39; cmd.script salt://test/shell.sh</span></span></code></pre></div><p><img src="https://resources-r2.xinlei3166.com/images/4262139-4bd3af9dc3922c5a.png" alt=""></p><p>客户端查看</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@client2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]# ll /tmp/</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-rw-r--r--</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> root</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> root</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  42</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 4月</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  26</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 14:20</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> shell.txt</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@client2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]# cat /tmp/shell.txt </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">salt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> server</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> do</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> shell</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> script</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> on</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> client</span></span></code></pre></div><p>文档参考 <a href="https://docs.saltstack.com/en/latest/ref/modules/all/index.html" target="_blank" rel="noreferrer">https://docs.saltstack.com/en/latest/ref/modules/all/index.html</a> 官网 <a href="http://docs.saltstack.cn/ref/states/all/index.html" target="_blank" rel="noreferrer">http://docs.saltstack.cn/ref/states/all/index.html</a> 中文官网</p></div></div></main><footer class="VPDocFooter" data-v-717456d7 data-v-8bd944f9><!--[--><!--]--><div class="edit-info" data-v-8bd944f9><!----><div class="last-updated" data-v-8bd944f9><p class="VPLastUpdated" data-v-8bd944f9 data-v-3d3da6d7>上次更新: <time datetime="2024-12-05T22:02:00.000Z" data-v-3d3da6d7></time></p></div></div><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-8bd944f9><span class="visually-hidden" id="doc-footer-aria-label" data-v-8bd944f9>Pager</span><div class="pager" data-v-8bd944f9><a class="VPLink link pager-link prev" href="/blog/Linux/Centos-7%E4%B8%8BNagios%E7%9A%84%E5%AE%89%E8%A3%85%E5%8F%8A%E9%85%8D%E7%BD%AE%EF%BC%88%E5%AE%8C%E6%95%B4%E7%89%88%EF%BC%89" data-v-8bd944f9><!--[--><span class="desc" data-v-8bd944f9>Previous page</span><span class="title" data-v-8bd944f9>Centos-7下Nagios的安装及配置（完整版）</span><!--]--></a></div><div class="pager" data-v-8bd944f9><a class="VPLink link pager-link next" href="/blog/Linux/Centos-7%E5%AE%89%E8%A3%85zabbix" data-v-8bd944f9><!--[--><span class="desc" data-v-8bd944f9>Next page</span><span class="title" data-v-8bd944f9>Centos-7安装zabbix</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-d1264ba6 data-v-b8974312><div class="container" data-v-b8974312><!----><p class="copyright" data-v-b8974312><a class="href" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a><span style="margin-left: 8px">Copyright © 2021-present 君惜</span></p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"about_index.md\":\"DqCC4YXw\",\"blog_docker_docker文档.md\":\"CIFOAe5D\",\"blog_git_git学习笔记.md\":\"6HOu7el9\",\"blog_javascript_element-ui 日期选择器-自定义前缀文本信息.md\":\"ByTTSypo\",\"blog_javascript_iview组件tabs嵌套使用.md\":\"DgDkJ0Ht\",\"blog_javascript_javascript原型继承.md\":\"DUYhKJlN\",\"blog_javascript_vue中使用jsx.md\":\"CYb3VoAU\",\"blog_javascript_web常用颜色值.md\":\"E59BLcYA\",\"blog_javascript_前端人员必看css命名规范.md\":\"ServkIUH\",\"blog_javascript_探索vue高阶组件.md\":\"Bqs2NiBz\",\"blog_linux_centos-7-下安装lnmp官方最新版（yum安装nginx和mysql，php7源码安装）.md\":\"Bra8SogD\",\"blog_linux_centos-7下nagios的安装及配置（完整版）.md\":\"CCdDWxhX\",\"blog_linux_centos-7下saltstack安装配置详解.md\":\"Cdvsc7u4\",\"blog_linux_centos-7安装zabbix.md\":\"CAuDE7ex\",\"blog_linux_centos-7系统优化脚本.md\":\"Bns3skJK\",\"blog_linux_centos7下编译安装nginx、mysql、php（文章底部包含一键安装脚本）.md\":\"Q0Xtg0Vx\",\"blog_linux_centos下安装ansible.md\":\"OWRFKt5n\",\"blog_linux_curl使用文档.md\":\"Cythek35\",\"blog_linux_php添加扩展库.md\":\"BrlybZvO\",\"blog_linux_saltstack-api使用详解.md\":\"DukkCH2k\",\"blog_linux_supervisor用法.md\":\"CerF3cXb\",\"blog_mysql_mysql中常用sql语句的编写.md\":\"DJrwsyxQ\",\"blog_mysql_mysql多表联合查询语句的编写及效率分析、优化.md\":\"b4LKPj5d\",\"blog_node.js_node.js - 使用pm2部署项目.md\":\"Cmi7YL-X\",\"blog_python_django-2-0-发布，都有哪些新特性要注意？.md\":\"BXv3ZAze\",\"blog_python_django-nginx-uwsgi.md\":\"D3Sb1a-h\",\"blog_python_django增加qq第三方登录.md\":\"C7kCV7Mi\",\"blog_python_linux下安装python-2.7.md\":\"DvLfNnRu\",\"blog_python_linux安装python-3-5-2.md\":\"DtdlbEn_\",\"blog_python_peewee-orm用法.md\":\"BONnuvsc\",\"blog_python_python-tab补全模块.md\":\"BJHiFMN6\",\"blog_python_python-八大算法.md\":\"QdnHOTtn\",\"blog_python_python-解析配置模块之configparser详解.md\":\"jIJEkZqj\",\"blog_python_python中hashlib加密模块的使用.md\":\"CBMWZqd3\",\"blog_python_python中logging生成日志模块的使用.md\":\"DavmQ33V\",\"blog_python_python中paramiko模块的使用.md\":\"DSaL15RR\",\"blog_python_python中shutil文件操作模块的使用.md\":\"C6SjS4CH\",\"blog_python_python中sys，os，time模块的使用（包括时间格式的各种转换）.md\":\"Bz469iFZ\",\"blog_python_python中yaml配置文件模块的使用.md\":\"SCKZfmMm\",\"blog_python_python中zipfile、tarfile压缩文件模块的使用.md\":\"Cvh-9YWn\",\"blog_python_python中使用subprocess批量执行linux下命令.md\":\"DwDlaob7\",\"blog_python_python中利用random模块生成随机验证码.md\":\"S7Zsye7T\",\"blog_python_python中操作mysql的pymysql模块详解.md\":\"BLx8s6VL\",\"blog_python_python中的单例模式.md\":\"CJuwqUtZ\",\"blog_python_python使用pickle和json模拟一个购物车.md\":\"Dx4ZQxuz\",\"blog_python_python使用requests模块模拟登录知乎.md\":\"BYwPfUnn\",\"blog_python_python写一个简单的图形化记事本.md\":\"DOuY2XIg\",\"blog_python_python多线程、锁、event事件机制的简单使用.md\":\"Dy9jUTWK\",\"blog_python_python更换pip和easy_install源.md\":\"CFYJVkfK\",\"blog_python_python终端输出带颜色.md\":\"CGb2Yg0d\",\"blog_python_python面试题.md\":\"CqQkYWjW\",\"blog_python_qqbot：基于smartqq协议的qq机器人的简单使用.md\":\"BiJc4kVc\",\"blog_python_sanic-jinja2模版用法.md\":\"DcnJwEnp\",\"blog_python_sanic异步框架之中文文档.md\":\"5PPuYRxS\",\"blog_python_sqlalchemy的简单使用.md\":\"Bw7T9IUi\",\"blog_python_virtualenv加django加uwsgi加nginx多站点部署.md\":\"DKD7yEWs\",\"blog_python_webapi的设计规范.md\":\"iQBcI9xC\",\"blog_python_xlcmdb.md\":\"DSAc0Zqf\",\"blog_python_不可不知的python模块--collections.md\":\"B5hit2vN\",\"blog_python_使用python--发送邮件.md\":\"BqayEE1x\",\"blog_python_使用sanic-openapi来构建api.md\":\"BS6A9IAO\",\"blog_python_初识aiohttp之服务端用法.md\":\"CLUUvA6J\",\"blog_python_更好的编写python代码的方式.md\":\"BE8slca_\",\"blog_python_用pyinotify监控linux文件系统.md\":\"Bg8qwcF5\",\"blog_redis_使用python来操作redis用法详解.md\":\"BgVBiDLn\",\"blog_并发测试_ab安装及使用.md\":\"TMLEz42N\",\"blog_并发测试_webbench安装及使用.md\":\"DFIZf-4d\",\"blog_并发测试_wrk安装及使用.md\":\"CTFFFX4c\",\"blog_随笔_代码编写前需要准备的事情.md\":\"Cz-bVVR9\",\"blog_随笔_优秀程序员的10个习惯.md\":\"Bir7H4gW\",\"index.md\":\"C145LPJ-\",\"package_index.md\":\"DIqHG-bK\",\"softwarecustom_index.md\":\"CbRwkRvX\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"君惜\",\"description\":\"欢迎来到君惜的网站。\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"outline\":{\"level\":[2,4]},\"outlineTitle\":\"本页目录\",\"lastUpdatedText\":\"上次更新\",\"logo\":\"/logo.png\",\"search\":{\"provider\":\"local\"},\"nav\":[{\"text\":\"主页\",\"link\":\"/\"},{\"text\":\"软件定制\",\"link\":\"/softwareCustom/\"},{\"text\":\"博客\",\"items\":[{\"text\":\"Docker\",\"link\":\"/blog/Docker/Docker文档.html\",\"activeMatch\":\"/blog/Docker\"},{\"text\":\"Git\",\"link\":\"/blog/Git/Git学习笔记.html\",\"activeMatch\":\"/blog/Git\"},{\"text\":\"JavaScript\",\"link\":\"/blog/JavaScript/JavaScript原型继承.html\",\"activeMatch\":\"/blog/JavaScript\"},{\"text\":\"Linux\",\"link\":\"/blog/Linux/Centos-7-下安装LNMP官方最新版（yum安装nginx和mysql，php7源码安装）.html\",\"activeMatch\":\"/blog/Linux\"},{\"text\":\"MySQL\",\"link\":\"/blog/MySQL/MySQL中常用SQL语句的编写.html\",\"activeMatch\":\"/blog/MySQL\"},{\"text\":\"Node.js\",\"link\":\"/blog/Node.js/Node.js - 使用pm2部署项目.html\",\"activeMatch\":\"/blog/Node.js\"},{\"text\":\"Python\",\"link\":\"/blog/Python/Django-2-0-发布，都有哪些新特性要注意？.html\",\"activeMatch\":\"/blog/Python\"},{\"text\":\"Redis\",\"link\":\"/blog/Redis/使用python来操作redis用法详解.html\",\"activeMatch\":\"/blog/Redis\"},{\"text\":\"并发测试\",\"link\":\"/blog/并发测试/ab安装及使用.html\",\"activeMatch\":\"/blog/并发测试\"},{\"text\":\"随笔\",\"link\":\"/blog/随笔/代码编写前需要准备的事情.html\",\"activeMatch\":\"/blog/随笔\"}]},{\"text\":\"开源项目\",\"link\":\"/package/\"},{\"text\":\"关于我\",\"link\":\"/about/\"}],\"sidebar\":{\"/blog/Docker/\":[{\"text\":\"Docker\",\"collapsible\":true,\"items\":[{\"text\":\"Docker文档\",\"link\":\"/blog/Docker/Docker文档.md\"}]}],\"/blog/Git/\":[{\"text\":\"Git\",\"collapsible\":true,\"items\":[{\"text\":\"Git学习笔记\",\"link\":\"/blog/Git/Git学习笔记.md\"}]}],\"/blog/JavaScript/\":[{\"text\":\"JavaScript\",\"collapsible\":true,\"items\":[{\"text\":\"JavaScript原型继承\",\"link\":\"/blog/JavaScript/JavaScript原型继承.md\"},{\"text\":\"element-ui 日期选择器-自定义前缀文本信息\",\"link\":\"/blog/JavaScript/element-ui 日期选择器-自定义前缀文本信息.md\"},{\"text\":\"iView组件Tabs嵌套使用\",\"link\":\"/blog/JavaScript/iView组件Tabs嵌套使用.md\"},{\"text\":\"vue中使用jsx\",\"link\":\"/blog/JavaScript/vue中使用jsx.md\"},{\"text\":\"web常用颜色值\",\"link\":\"/blog/JavaScript/web常用颜色值.md\"},{\"text\":\"前端人员必看CSS命名规范\",\"link\":\"/blog/JavaScript/前端人员必看CSS命名规范.md\"},{\"text\":\"探索Vue高阶组件\",\"link\":\"/blog/JavaScript/探索Vue高阶组件.md\"}]}],\"/blog/Linux/\":[{\"text\":\"Linux\",\"collapsible\":true,\"items\":[{\"text\":\"Centos-7-下安装LNMP官方最新版（yum安装nginx和mysql，php7源码安装）\",\"link\":\"/blog/Linux/Centos-7-下安装LNMP官方最新版（yum安装nginx和mysql，php7源码安装）.md\"},{\"text\":\"Centos-7下Nagios的安装及配置（完整版）\",\"link\":\"/blog/Linux/Centos-7下Nagios的安装及配置（完整版）.md\"},{\"text\":\"Centos-7下saltstack安装配置详解\",\"link\":\"/blog/Linux/Centos-7下saltstack安装配置详解.md\"},{\"text\":\"Centos-7安装zabbix\",\"link\":\"/blog/Linux/Centos-7安装zabbix.md\"},{\"text\":\"Centos-7系统优化脚本\",\"link\":\"/blog/Linux/Centos-7系统优化脚本.md\"},{\"text\":\"Centos7下编译安装Nginx、Mysql、PHP（文章底部包含一键安装脚本）\",\"link\":\"/blog/Linux/Centos7下编译安装Nginx、Mysql、PHP（文章底部包含一键安装脚本）.md\"},{\"text\":\"Centos下安装Ansible\",\"link\":\"/blog/Linux/Centos下安装Ansible.md\"},{\"text\":\"curl使用文档\",\"link\":\"/blog/Linux/curl使用文档.md\"},{\"text\":\"php添加扩展库\",\"link\":\"/blog/Linux/php添加扩展库.md\"},{\"text\":\"saltstack-api使用详解\",\"link\":\"/blog/Linux/saltstack-api使用详解.md\"},{\"text\":\"supervisor用法\",\"link\":\"/blog/Linux/supervisor用法.md\"}]}],\"/blog/MySQL/\":[{\"text\":\"MySQL\",\"collapsible\":true,\"items\":[{\"text\":\"MySQL中常用SQL语句的编写\",\"link\":\"/blog/MySQL/MySQL中常用SQL语句的编写.md\"},{\"text\":\"MySQL多表联合查询语句的编写及效率分析、优化\",\"link\":\"/blog/MySQL/MySQL多表联合查询语句的编写及效率分析、优化.md\"}]}],\"/blog/Node.js/\":[{\"text\":\"Node.js\",\"collapsible\":true,\"items\":[{\"text\":\"Node.js - 使用pm2部署项目\",\"link\":\"/blog/Node.js/Node.js - 使用pm2部署项目.md\"}]}],\"/blog/Python/\":[{\"text\":\"Python\",\"collapsible\":true,\"items\":[{\"text\":\"Django-2-0-发布，都有哪些新特性要注意？\",\"link\":\"/blog/Python/Django-2-0-发布，都有哪些新特性要注意？.md\"},{\"text\":\"Django-Nginx-uwsgi\",\"link\":\"/blog/Python/Django-Nginx-uwsgi.md\"},{\"text\":\"Django增加QQ第三方登录\",\"link\":\"/blog/Python/Django增加QQ第三方登录.md\"},{\"text\":\"Linux下安装python-2.7\",\"link\":\"/blog/Python/Linux下安装python-2.7.md\"},{\"text\":\"Linux安装python-3-5-2\",\"link\":\"/blog/Python/Linux安装python-3-5-2.md\"},{\"text\":\"Python-解析配置模块之ConfigParser详解\",\"link\":\"/blog/Python/Python-解析配置模块之ConfigParser详解.md\"},{\"text\":\"Python中的单例模式\",\"link\":\"/blog/Python/Python中的单例模式.md\"},{\"text\":\"QQBot：基于SmartQQ协议的QQ机器人的简单使用\",\"link\":\"/blog/Python/QQBot：基于SmartQQ协议的QQ机器人的简单使用.md\"},{\"text\":\"SQLAlchemy的简单使用\",\"link\":\"/blog/Python/SQLAlchemy的简单使用.md\"},{\"text\":\"Virtualenv加Django加UWSGI加Nginx多站点部署\",\"link\":\"/blog/Python/Virtualenv加Django加UWSGI加Nginx多站点部署.md\"},{\"text\":\"WebAPI的设计规范\",\"link\":\"/blog/Python/WebAPI的设计规范.md\"},{\"text\":\"peewee-orm用法\",\"link\":\"/blog/Python/peewee-orm用法.md\"},{\"text\":\"python-tab补全模块\",\"link\":\"/blog/Python/python-tab补全模块.md\"},{\"text\":\"python-八大算法\",\"link\":\"/blog/Python/python-八大算法.md\"},{\"text\":\"python中hashlib加密模块的使用\",\"link\":\"/blog/Python/python中hashlib加密模块的使用.md\"},{\"text\":\"python中logging生成日志模块的使用\",\"link\":\"/blog/Python/python中logging生成日志模块的使用.md\"},{\"text\":\"python中paramiko模块的使用\",\"link\":\"/blog/Python/python中paramiko模块的使用.md\"},{\"text\":\"python中shutil文件操作模块的使用\",\"link\":\"/blog/Python/python中shutil文件操作模块的使用.md\"},{\"text\":\"python中sys，os，time模块的使用（包括时间格式的各种转换）\",\"link\":\"/blog/Python/python中sys，os，time模块的使用（包括时间格式的各种转换）.md\"},{\"text\":\"python中yaml配置文件模块的使用\",\"link\":\"/blog/Python/python中yaml配置文件模块的使用.md\"},{\"text\":\"python中zipfile、tarfile压缩文件模块的使用\",\"link\":\"/blog/Python/python中zipfile、tarfile压缩文件模块的使用.md\"},{\"text\":\"python中使用subprocess批量执行linux下命令\",\"link\":\"/blog/Python/python中使用subprocess批量执行linux下命令.md\"},{\"text\":\"python中利用random模块生成随机验证码\",\"link\":\"/blog/Python/python中利用random模块生成随机验证码.md\"},{\"text\":\"python中操作mysql的pymysql模块详解\",\"link\":\"/blog/Python/python中操作mysql的pymysql模块详解.md\"},{\"text\":\"python使用pickle和json模拟一个购物车\",\"link\":\"/blog/Python/python使用pickle和json模拟一个购物车.md\"},{\"text\":\"python使用requests模块模拟登录知乎\",\"link\":\"/blog/Python/python使用requests模块模拟登录知乎.md\"},{\"text\":\"python写一个简单的图形化记事本\",\"link\":\"/blog/Python/python写一个简单的图形化记事本.md\"},{\"text\":\"python多线程、锁、event事件机制的简单使用\",\"link\":\"/blog/Python/python多线程、锁、event事件机制的简单使用.md\"},{\"text\":\"python更换pip和easy_install源\",\"link\":\"/blog/Python/python更换pip和easy_install源.md\"},{\"text\":\"python终端输出带颜色\",\"link\":\"/blog/Python/python终端输出带颜色.md\"},{\"text\":\"python面试题\",\"link\":\"/blog/Python/python面试题.md\"},{\"text\":\"sanic-jinja2模版用法\",\"link\":\"/blog/Python/sanic-jinja2模版用法.md\"},{\"text\":\"sanic异步框架之中文文档\",\"link\":\"/blog/Python/sanic异步框架之中文文档.md\"},{\"text\":\"xlcmdb\",\"link\":\"/blog/Python/xlcmdb.md\"},{\"text\":\"不可不知的python模块--collections\",\"link\":\"/blog/Python/不可不知的python模块--collections.md\"},{\"text\":\"使用python--发送邮件\",\"link\":\"/blog/Python/使用python--发送邮件.md\"},{\"text\":\"使用sanic-openapi来构建API\",\"link\":\"/blog/Python/使用sanic-openapi来构建API.md\"},{\"text\":\"初识aiohttp之服务端用法\",\"link\":\"/blog/Python/初识aiohttp之服务端用法.md\"},{\"text\":\"更好的编写Python代码的方式\",\"link\":\"/blog/Python/更好的编写Python代码的方式.md\"},{\"text\":\"用pyinotify监控Linux文件系统\",\"link\":\"/blog/Python/用pyinotify监控Linux文件系统.md\"}]}],\"/blog/Redis/\":[{\"text\":\"Redis\",\"collapsible\":true,\"items\":[{\"text\":\"使用python来操作redis用法详解\",\"link\":\"/blog/Redis/使用python来操作redis用法详解.md\"}]}],\"/blog/并发测试/\":[{\"text\":\"并发测试\",\"collapsible\":true,\"items\":[{\"text\":\"ab安装及使用\",\"link\":\"/blog/并发测试/ab安装及使用.md\"},{\"text\":\"webbench安装及使用\",\"link\":\"/blog/并发测试/webbench安装及使用.md\"},{\"text\":\"wrk安装及使用\",\"link\":\"/blog/并发测试/wrk安装及使用.md\"}]}],\"/blog/随笔/\":[{\"text\":\"随笔\",\"collapsible\":true,\"items\":[{\"text\":\"代码编写前需要准备的事情\",\"link\":\"/blog/随笔/代码编写前需要准备的事情.md\"},{\"text\":\"优秀程序员的10个习惯\",\"link\":\"/blog/随笔/优秀程序员的10个习惯.md\"}]}]},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/xinlei3166/xinlei3166.github.io\"}],\"footer\":{\"copyright\":\"<a class=\\\"href\\\" href=\\\"https://creativecommons.org/licenses/by-nc-sa/4.0/\\\">CC BY-NC-SA 4.0</a><span style=\\\"margin-left: 8px\\\">Copyright © 2021-present 君惜</span>\"}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":true}");</script>
    
  </body>
</html>